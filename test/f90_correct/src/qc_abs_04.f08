!** Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.
!** See https://llvm.org/LICENSE.txt for license information.
!** SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception

!*  Test intrinsics function abs with quad precision complex.

program main
  use check_mod
  implicit none

  complex(kind=16), parameter :: t1(1,2,1,1,2,1,1) = reshape(&
                   [(1.384652367324898473578347309734565E+400_16, &
                     -89723746656234.27467346572346727836E+300_16), &
                    (-1746375634.27634756437627364767623234E+2000_16, &
                     9832.2343767236434348778783245433323E+2300_16), &
                    (-873245736712234.2348667234663246768734E-1000_16, &
                     -9.3958340233454645675235423234623532E-945_16), &
                    (1876234.87534865723647324325435278E+30_16, &
                     98723467.2354378728374823726347623E+40_16)], &
                   (/1,2,1,1,2,1,1/))

  real(kind=16), parameter :: t2(4) = reshape(abs(t1), (/4/))
  real(kind=16) :: t3(4) = reshape(abs(t1), (/4/))
  real(kind=16), dimension(12) :: rslt, expect

  type mytype1
    complex(kind=16) :: m
  end type

  type(mytype1) :: dt1(2,1,1,1,1,1,2)

  dt1(:,:,:,:,:,:,:)%m = reshape(t1, (/2,1,1,1,1,1,2/))

  data expect / 1.38465236732489847357834730973456491E+0400_16, &
                9.83223437672364343487787832454333215E+2303_16, &
                9.39583402334546456752354232346235322E-0945_16, &
                9.87234672354378728374825509235423542E+0047_16, &
                1.38465236732489847357834730973456491E+0400_16, &
                9.83223437672364343487787832454333215E+2303_16, &
                9.39583402334546456752354232346235322E-0945_16, &
                9.87234672354378728374825509235423542E+0047_16, &
                1.38465236732489847357834730973456491E+0400_16, &
                9.83223437672364343487787832454333215E+2303_16, &
                9.39583402334546456752354232346235322E-0945_16, &
                9.87234672354378728374825509235423542E+0047_16 /

  rslt(1:4) = t2
  rslt(5:8) = t3
  rslt(9:12) = reshape(abs(dt1(:,:,:,:,:,:,:)%m), (/4/))

  call checkr16(rslt, expect, 12, rtoler = 1.0E-33_16)
end program
