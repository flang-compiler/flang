!** Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.
!** See https://llvm.org/LICENSE.txt for license information.
!** SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception

!*  Test intrinsics function abs with quad precision complex.

program main
  use check_mod
  implicit none

  complex(kind=16), parameter :: t1(3) = [&
                    (1.384652367324898473578347309734565E+400_16, &
                     -89723746656234.27467346572346727836E+300_16), &
                    (-1746375634.27634756437627364767623234E+2000_16, &
                     9832.2343767236434348778783245433323E+2300_16), &
                    (-873245736712234.2348667234663246768734E-1000_16, &
                     -9.3958340233454645675235423234623532E-945_16)]
  complex(kind=16), parameter :: t2(2,2) = reshape(&
                   [(1876234.87534865723647324325435278E+30_16, &
                     98723467.2354378728374823726347623E+40_16), &
                    (1.389475732374989345788734723432E-30_16, &
                     0.02387097432867437234239087834E-20_16), &
                    (-129037234.2785972349865873447837E+330_16, &
                     -43998.5464873845907987458768783905E+400_16), &
                    (-23.9438000934567304378754376287498E+2000_16, &
                     0.4892734823474736763877843223E+874_16)], (/2,2/))

  real(kind=16), parameter :: t3(3) = abs(t1)
  real(kind=16), parameter :: t4(2,2) = abs(t2)
  real(kind=16) :: t5(3) = abs(t1)
  real(kind=16) :: t6(2,2) = abs(t2)
  real(kind=16), dimension(25) :: rslt, expect

  type mytype
    complex(kind=16) :: m
    complex(kind=16) :: marr(2)
  end type

  type(mytype) :: dt(2)

  dt(:)%m = t1(2:3)
  dt(2)%marr(:) = t2(2,:)

  data expect /1.38465236732489847357834730973456491E+0400_16, &
               9.83223437672364343487787832454333215E+2303_16, &
               9.39583402334546456752354232346235322E-0945_16, &
               9.87234672354378728374825509235423542E+0047_16, &
               2.38709743286743727467821663277466343E-0022_16, &
               4.39985464873845907987458768783905004E+0404_16, &
               2.39438000934567304378754376287498012E+2001_16, &
               1.38465236732489847357834730973456491E+0400_16, &
               9.83223437672364343487787832454333215E+2303_16, &
               9.39583402334546456752354232346235322E-0945_16, &
               9.87234672354378728374825509235423542E+0047_16, &
               2.38709743286743727467821663277466343E-0022_16, &
               4.39985464873845907987458768783905004E+0404_16, &
               2.39438000934567304378754376287498012E+2001_16, &
               1.38465236732489847357834730973456491E+0400_16, &
               9.83223437672364343487787832454333215E+2303_16, &
               9.39583402334546456752354232346235322E-0945_16, &
               9.87234672354378728374825509235423682E+0047_16, &
               2.38709743286743727467821663277466343E-0022_16, &
               4.39985464873845907987458768783905004E+0404_16, &
               2.39438000934567304378754376287498012E+2001_16, &
               9.83223437672364343487787832454333215E+2303_16, &
               9.39583402334546456752354232346235322E-0945_16, &
               2.38709743286743727467821663277466343E-0022_16, &
               2.39438000934567304378754376287498012E+2001_16/

  rslt(1:3) = t3
  rslt(4:7) = reshape(t4, (/4/))
  rslt(8:10) = t3
  rslt(11:14) = reshape(t4, (/4/))
  rslt(15:17) = abs(t1)
  rslt(18:21) = reshape(abs(t2), (/4/))
  rslt(22:23) = abs(dt(:)%m)
  rslt(24:25) = abs(dt(2)%marr(:))

  call checkr16(rslt, expect, 25, rtoler = 1.0E-33_16)
end program
