!** Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.
!** See https://llvm.org/LICENSE.txt for license information.
!** SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception

!*  Test intrinsics function abs with quad precision complex.

program main
  use check_mod
  implicit none
  integer, parameter :: k = 16
  integer, parameter :: n = 15
  complex(kind=k), parameter :: t1 = (1.23434590874573456543454E+30_16, &
                                      8543.32435646789855443523E+24_16)
  complex(kind=k), parameter :: t2 = (-1432423456675345.234098978234E-14_16, &
                                      3245456.2098672012672343443E-10_16)
  complex(kind=k), parameter :: t3 = (-31289456674353214321.44513243454E+253_16, &
                                      -9234398757643576879856799.9563549E+291_16)
  complex(kind=k), parameter :: t4 = (1.123456799992567578890565699999E-301_16, &
                                      -9125426546546752345354366767.783E-291_16)
  complex(kind=k), parameter :: t5 = (9.99346779800346575656908785449E+991_16, &
                                      499999999.123456999097234575676549E+990_16)
  complex(kind=k), parameter :: t6 = (-0.123449902375486542387483475999E-995_16, &
                                      -9902305893457823405468723499.1234E-999_16)
  complex(kind=k), parameter :: t7 = (3.141592673590003254332434344E+3997_16, &
                                      9903473676724367674367243454.3456E+3999_16)
  complex(kind=k), parameter :: t8 = (-9.123456770563732646435723823543532_16, &
                                      1.012339992354898596734564736572374_16)
  complex(kind=k) :: t9, t10, t11, t12, t13, t14, t15
  real(kind=k) :: rslt(n), expect(n)

  expect = (/1234375474006346701273495105714.10278_16, &
             14.3242345704300837029408346143477105_16, &
             9.23439875764357687985679995635490048E+0315_16, &
             9.12542654654675234535436676778300015E-0264_16, &
             4.99999999123466986037115056765181124E+0998_16, &
             9.90230589345782340546872349912340028E-0972_16, &
             9.90347367672436767436724345434560007E+4026_16, &
             9.17944964060843518655764186386383045_16, &
             9.00935489794353454358762354456678788E+0954_16, &
             3.34547683543666455467545134570982354E-0476_16, &
             123439235546941617174477702413042752._16, &
             1.01234236789034878567098465667887548E-0076_16, &
             5.23968542342384671300572564697227326E+0104_16, &
             3.14159262356756723435456346346539989E+3402_16, &
             1.97346342390475743764554484300000008E+3105_16/)

  rslt(1) = abs(t1)
  rslt(2) = abs(t2)
  rslt(3) = abs(t3)
  rslt(4) = abs(t4)
  rslt(5) = abs(t5)
  rslt(6) = abs(t6)
  rslt(7) = abs(t7)
  rslt(8) = abs(t8)

  t9 = (1.12323569653447898456777456565756E+747_16, &
        9.009354897943534543587623544566788E+954_16)
  rslt(9) = abs(t9)
  t10 = (-9.1230963456786235435734859056834E-543_16, &
         -334547683543666455467545.1345709823413E-499_16)
  rslt(10) = abs(t10)
  t11 = (123439235546899098435676898098045555.85499_16, &
         1024546788974565657567.6456758768764576579E+8_16)
  rslt(11) = abs(t11)
  t12 = (-1.01234236789034878567098465667887546E-76_16, &
         0.0013145346678674354345654656573499E-94_16)
  rslt(12) = abs(t12)
  t13 = (-0.01972384754676734239075874387349E+100_16, &
         52396854234.234754787324723454E+94_16)
  rslt(13) = abs(t13)
  t14 = (-123456789.00962347623646546235467E+3297_16, &
         -31415926.235675672343545634634654E+3395_16)
  rslt(14) = abs(t14)
  t15 = (-19734634.23904757437645544843E+3098_16, &
         -1.4354698348577345878458768549E+26_16)
  rslt(15) = abs(t15)

  call checkr16(rslt, expect, n, rtoler = 1.0E-33_16)
end program main
